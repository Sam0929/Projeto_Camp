{% extends "base.html" %}

{% block title %}Registrar Penalidade{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center">Registrar Penalidade para {{ campeonato.nome }}</h1>

    <form method="post" action="{% url 'registrar_penalidade' campeonato.id %}">
        {% csrf_token %}

        <!-- Seção de Seleção de Jogo -->
        <div class="mb-4">
            <label for="jogo_selecionado" class="form-label">Selecione um Jogo:</label>
            <select id="jogo_selecionado" name="jogo_id" class="form-select" required>
                <option value="">Escolha um jogo...</option>
                {% for jogo in jogos %}
                    <option value="{{ jogo.id }}">
                        Rodada {{ jogo.rodada.numero }}: {{ jogo.time_casa.equipe }} vs {{ jogo.time_fora.equipe }} ({{ jogo.data_horario|date:"d/m/Y H:i" }})
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Seção de Tipo de Penalidade -->
        <div class="mb-3">
            <label for="tipo_penalidade" class="form-label">Tipo de Penalidade:</label>
            <select id="tipo_penalidade" name="tipo_penalidade" class="form-select" required>
                <option value="">Selecione o tipo de penalidade...</option>
                <option value="participante">Por Participante</option>
                <option value="equipe">Por Equipe</option>
            </select>
        </div>

        <!-- Seção de Seleção de Participante -->
        <div class="mb-3" id="participante_selecao" style="display: none;">
            <label for="participante_id" class="form-label">Selecione o Participante:</label>
            <select id="participante_id" name="participante_id" class="form-select">
                <option value="">Escolha um participante...</option>
                {% for participante in participantes %}
                    <option value="{{ participante.id }}">{{ participante.nome }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Seção de Tipo Específico de Penalidade -->
        <div class="mb-3" id="tipo_cartao_selecao" style="display: none;">
            <label for="tipo_cartao" class="form-label">Tipo de Penalidade Específica:</label>
            <select id="tipo_cartao" name="tipo_cartao" class="form-select">
                <!-- As opções serão adicionadas dinamicamente pelo JavaScript -->
            </select>
        </div>

        <!-- Campo para Motivo da Penalidade -->
        <div class="mb-3">
            <label for="motivo" class="form-label">Motivo da Penalidade:</label>
            <textarea id="motivo" name="motivo" class="form-control" rows="3" placeholder="Descreva o motivo da penalidade"></textarea>
        </div>

        <!-- Botões de Ação -->
        <div class="text-center">
            <button type="submit" class="btn btn-primary">Registrar Penalidade</button>
            <a href="{% url 'visualizar_tabela' campeonato.id %}" class="btn btn-secondary">Voltar</a>
        </div>
    </form>
</div>

<script>
    document.getElementById('tipo_penalidade').addEventListener('change', function() {
        const participanteSelecao = document.getElementById('participante_selecao');
        const tipoCartaoSelecao = document.getElementById('tipo_cartao_selecao');
        const tipoCartaoSelect = document.getElementById('tipo_cartao');

        participanteSelecao.style.display = this.value === 'participante' ? 'block' : 'none';
        tipoCartaoSelect.innerHTML = '';

        if (this.value === 'participante') {
            tipoCartaoSelecao.style.display = 'block';
            tipoCartaoSelect.options.add(new Option('Cartão Amarelo', 'amarelo'));
            tipoCartaoSelect.options.add(new Option('Cartão Vermelho', 'vermelho'));
        } else if (this.value === 'equipe') {
            tipoCartaoSelecao.style.display = 'block';
            tipoCartaoSelect.options.add(new Option('Expulsão', 'expulsao'));
            tipoCartaoSelect.options.add(new Option('Outro', 'outro'));
        } else {
            tipoCartaoSelecao.style.display = 'none';
        }
    });
</script>
{% endblock %}
